YUI.add("moodle-atto_edusharing-button",function(e,t){YUI.add("moodle-atto_edusharing-button",function(e,t){var n="atto_edusharing",r="edusharing_flavor",i="atto_edusharing",s={INPUTSUBMIT:"atto_media_urlentrysubmit",INPUTCANCEL:"atto_media_urlentrycancel",FLAVORCONTROL:"flavorcontrol",EDUSHARING_HINT_CHECK:"edusharing_hint_check"},o={FLAVORCONTROL:".flavorcontrol"},u='{{#if edusharing_hint_hide}}<div id="edusharing_hint">W\u00e4hlen Sie ein edu-sharing Objekt aus dem Repositorium um es im Kurs anzuzeigen. Klicken Sie dazu auf den Button und anschlie\u00dfend auf bla...<button onclick="window.win = window.open(\'http://localhost:8080/edu-sharing/components/search?reurl=WINDOW\');">open repo</button><br/><br/><input type="checkbox" id="{{CSS.EDUSHARING_HINT_CHECK}}" name="{{CSS.EDUSHARING_HINT_CHECK}}" value="dontshow"> Beim n\u00e4chsten mal direkt zur Suche springen</div>{{/if}}<form id="edusharing_form" class="atto_form" style="display: none"><input id="edusharing_node_id" name="edusharing_node_id" value="" /><button class="{{CSS.INPUTSUBMIT}}">{{get_string "insert" component}}</button></form>';e.namespace("M.atto_edusharing").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){if(this.get("disabled"))return;this.addButton({icon:"icon",iconComponent:"atto_edusharing",buttonName:"icon",callback:this._displayDialogue,callbackArgs:"icon"});var e=this.get("host").textarea.ancestor("form");e&&e.on("submit",this.eduSubmit,this);var t=this;window.addEventListener("message",function(e){if(e.data.event=="APPLY_NODE"){var n=e.data.data;console.log(n),window.win.close(),t.setFormValues(n)}},!1)},checkFunc:function(){alert("checkFunc")},setFormValues:function(t){e.one("#edusharing_form").set("style","display:block"),e.one("#edusharing_hint").set("style","display:none"),e.one("#edusharing_node_id").set("value",t.objectUrl)},eduSubmit:function(){var e=this.get("host");window.console.log("neu:"),window.console.log(this.get("host").textarea.get("value"))},_displayDialogue:function(t,r){t.preventDefault();var i=800,s=600,o=this.getDialogue({headerContent:M.util.get_string("dialogtitle",n),width:i+"px",height:s+"px",focusAfterHide:r});o.width!==i+"px"&&o.set("width",i+"px");var u=this._getFormContent(r),a=e.Node.create("<div></div>");a.append(u),o.set("bodyContent",a),o.show(),this.markUpdated()},_getFormContent:function(t){var i=e.Handlebars.compile(u),o=e.Node.create(i({elementid:this.get("host").get("elementid"),CSS:s,FLAVORCONTROL:r,component:n,defaultflavor:this.get("defaultflavor"),clickedicon:t,edusharing_hint_hide:e.Cookie.get("edusharing_hint_hide")}));return this._form=o,this._form.one("."+s.INPUTSUBMIT).on("click",this._doInsert,this),this._form.one("#"+s.EDUSHARING_HINT_CHECK).on("change",this.edusharing_hint_check_change,this),o},edusharing_hint_check_change:function(){YUI().use("cookie",function(e){e.Cookie.set("edusharing_hint_hide",!0,{expires:new Date("January 12, 2025")})})},_doInsert:function(t){t.preventDefault(),this.getDialogue({focusAfterHide:null}).hide(),this.editor.focus(),this.get("host").insertContentAtFocusPoint(e.one("#edusharing_node_id").get("value")),this.markUpdated()}},{ATTRS:{disabled:{value:!1},usercontextid:{value:null},defaultflavor:{value:""}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
