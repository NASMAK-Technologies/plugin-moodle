define(["jquery"],function(t){return{init:function(){!function(){jQuery.expr[":"]["near-viewport"]=function(t,e,a){return function(t,e){var a=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,n=a+document.documentElement.clientHeight;e=e||0;var o=t.getBoundingClientRect();if(0===o.height)return!1;var d=o.top+a-e;return o.bottom+a+e>a&&n>d}(t,parseInt(a[3])||0)}}(),t.ajaxSetup({cache:!1});var e="webm",a=document.createElement("video");function n(a,o){var d=a.attr("data-url")+"&videoFormat="+e;if(void 0===o)o=a.parent();t.get(d,function(t){o.html("").append(t).css({height:"auto",width:"auto"}),t.toLowerCase().indexOf('data-view="lock"')>=0&&setTimeout(function(){n(a,o)},1111)}),a.removeAttr("data-type")}a.canPlayType&&a.canPlayType("video/mp4").replace(/no/,"")&&(e="mp4"),t("div[data-type='esObject']:near-viewport(400)").each(function(){n(t(this))}),t(window).scroll(function(){t("div[data-type='esObject']:near-viewport(400)").each(function(){n(t(this))})}),t("body").click(function(e){t(e.target).closest(".edusharing_metadata").length||(t(e.target).closest(".edusharing_metadata_toggle_button").length?(t(".edusharing_metadata").hide(),toggle_button=t(e.target),metadata=toggle_button.parent().find(".edusharing_metadata"),metadata.hasClass("open")?(metadata.toggleClass("open"),metadata.hide()):(t(".edusharing_metadata").removeClass("open"),metadata.toggleClass("open"),metadata.show())):(t(".edusharing_metadata").hide(),t(".edusharing_metadata").removeClass("open")))})}}});